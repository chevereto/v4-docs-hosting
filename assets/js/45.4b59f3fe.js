(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{374:function(e,t,r){"use strict";r.r(t);var a=r(25),s=Object(a.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"cron"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cron"}},[e._v("#")]),e._v(" CRON")]),e._v(" "),t("p",[e._v("Chevereto requires to setup "),t("a",{attrs:{href:"https://en.wikipedia.org/wiki/Cron",target:"_blank",rel:"noopener noreferrer"}},[e._v("cron"),t("OutboundLink")],1),e._v(" to run background jobs.")]),e._v(" "),t("p",[e._v("This cron setup reference applies "),t("em",[e._v("mostly")]),e._v(" for "),t("strong",[e._v("Debian-based")]),e._v(" systems. We "),t("strong",[e._v("recommend")]),e._v(" checking your server documentation on how to setup and run cron.")]),e._v(" "),t("p",[e._v("Consider to contribute to this documentation with alternative cron setup alternatives.")]),e._v(" "),t("h2",{attrs:{id:"what-it-does"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#what-it-does"}},[e._v("#")]),e._v(" What it does?")]),e._v(" "),t("p",[e._v("A cron is system in which a command is executed in a regular basis, this way Chevereto can perform operations in the background without user intervention.")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("Job")]),e._v(" "),t("th",[e._v("Purpose")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("checkForNews")]),e._v(" "),t("td",[e._v("Check for news about Chevereto")])]),e._v(" "),t("tr",[t("td",[e._v("checkForUpdates")]),e._v(" "),t("td",[e._v("Check for available Chevereto updates")])]),e._v(" "),t("tr",[t("td",[e._v("checkHtaccess")]),e._v(" "),t("td",[e._v("Check the integrity of the "),t("code",[e._v(".htaccess")]),e._v(" files")])]),e._v(" "),t("tr",[t("td",[e._v("cleanUnconfirmedUsers")]),e._v(" "),t("td",[e._v("Clears records for users which never confirmed their account")])]),e._v(" "),t("tr",[t("td",[e._v("deleteExpiredImages")]),e._v(" "),t("td",[e._v("Deletes files set to expire at a certain date")])]),e._v(" "),t("tr",[t("td",[e._v("removeDeleteLog")]),e._v(" "),t("td",[e._v("Removes the old delete log entries")])]),e._v(" "),t("tr",[t("td",[e._v("storageDelete")]),e._v(" "),t("td",[e._v("Delete files queued to removal")])]),e._v(" "),t("tr",[t("td",[e._v("deleteExpiredUploads")]),e._v(" "),t("td",[e._v("Deletes orphan/abandoned chunked uploads")])])])]),e._v(" "),t("h2",{attrs:{id:"troubleshoot"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#troubleshoot"}},[e._v("#")]),e._v(" Troubleshoot")]),e._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),t("p",[e._v("Refer to your system documentation and/or administrator for the best strategy when running Chevereto's cron requirements.")])]),e._v(" "),t("p",[e._v("Having issues? Check the following common pitfalls:")]),e._v(" "),t("ul",[t("li",[e._v("Invalid format for cron schedule")]),e._v(" "),t("li",[e._v("The PHP binary "),t("strong",[e._v("may not")]),e._v(" be available in cron context, use the full PHP path binary")]),e._v(" "),t("li",[e._v("The location of the "),t("code",[e._v("app/bin/cli")]),e._v(" console may vary, use what reflects the file in your system")]),e._v(" "),t("li",[e._v("Wrong user running the command (requires a "),t("strong",[e._v("normal user")]),e._v(" with access to the project directory)")]),e._v(" "),t("li",[e._v("User "),t("code",[e._v("www-data")]),e._v(" applies only for "),t("strong",[e._v("Debian-based")]),e._v(" system. Refer to your sysadmin for the appropriate user when using other OS")])]),e._v(" "),t("h2",{attrs:{id:"command"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#command"}},[e._v("#")]),e._v(" Command")]),e._v(" "),t("p",[e._v("The command should be run by the web-server user which is "),t("code",[e._v("www-data")]),e._v(" (may vary). To run the command in Chevereto it requires to call PHP binary at the Chevereto CLI.")]),e._v(" "),t("p",[e._v("Use "),t("code",[e._v("which php")]),e._v(" to locate the PHP binary as its location.")]),e._v(" "),t("p",[e._v("Refer to "),t("RouterLink",{attrs:{to:"/application/reference/cli.html#cron"}},[e._v("CLI Cron")]),e._v(".")],1),e._v(" "),t("h3",{attrs:{id:"docker-command"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-command"}},[e._v("#")]),e._v(" Docker command")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("exec")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-it")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--user")]),e._v(" www-data "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    chevereto-container app/bin/cli "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-C")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cron")]),e._v("\n")])])]),t("h2",{attrs:{id:"cron-d-file"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cron-d-file"}},[e._v("#")]),e._v(" Cron.d file")]),e._v(" "),t("p",[e._v("Recommended setup is to create a "),t("a",{attrs:{href:"https://manpages.debian.org/stretch/cron/cron.8",target:"_blank",rel:"noopener noreferrer"}},[e._v("cron.d file"),t("OutboundLink")],1),e._v(". This is easy as:")]),e._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("/etc/cron.d/chevereto "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("EOM\n* * * * * www-data php /var/www/html/app/bin/cli -C cron\nEOM")]),e._v("\n")])])]),t("p",[e._v("In the instruction above "),t("a",{attrs:{href:"https://crontab.guru/#*_*_*_*_*",target:"_blank",rel:"noopener noreferrer"}},[e._v("* * * * *"),t("OutboundLink")],1),e._v(" is the cron schedule to run every minute.")]),e._v(" "),t("h2",{attrs:{id:"cpanel-plesk"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cpanel-plesk"}},[e._v("#")]),e._v(" cPanel/Plesk")]),e._v(" "),t("p",[e._v("Refer to "),t("RouterLink",{attrs:{to:"/guides/cpanel/cron.html"}},[e._v("cPanel CRON")]),e._v(" and "),t("RouterLink",{attrs:{to:"/guides/plesk/cron.html"}},[e._v("Plesk CRON")]),e._v(" to learn how to setup cron jobs in those systems.")],1)])}),[],!1,null,null,null);t.default=s.exports}}]);